<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>–û–ø—Ä–æ—Å–Ω–∏–∫ —ç–∫—Å–ø–µ—Ä—Ç–∞ ‚Äî 98 –≤–æ–ø—Ä–æ—Å–æ–≤</title>

  <!-- Tailwind CDN to match original styling -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Lucide icons -->
  <script src="https://unpkg.com/lucide@latest"></script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@700;800;900&display=swap');
    * {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      font-weight: 800;
    }
  </style>
</head>
<body class="min-h-screen bg-black pb-20 text-white">
  <!-- Sticky header -->
  <header class="sticky top-0 z-50 bg-black/95 backdrop-blur-xl border-b border-gray-800">
    <div class="px-4 pt-6 pb-4">
      <h1 class="text-3xl text-white mb-1 tracking-tight">–û–ü–†–û–°–ù–ò–ö</h1>
      <p class="text-sm text-gray-400 tracking-wide">98 –í–û–ü–†–û–°–û–í</p>

      <!-- Total progress -->
      <div class="mt-5 mb-4">
        <div class="flex items-center justify-between mb-2">
          <span class="text-xs text-gray-400 tracking-widest">–ü–†–û–ì–†–ï–°–°</span>
          <span id="total-filled" class="text-lg text-white">0<span class="text-gray-600">/98</span></span>
        </div>
        <div class="h-2 bg-gray-900 rounded-full overflow-hidden">
          <div id="total-bar" class="h-full bg-gradient-to-r from-blue-500 via-purple-500 to-cyan-400 rounded-full transition-all duration-700 ease-out" style="width:0%"></div>
        </div>
      </div>

      <!-- Action buttons -->
      <div class="grid grid-cols-3 gap-2 mt-4">
        <button id="btn-save" class="flex flex-col items-center justify-center gap-1 py-3 bg-gray-900 text-white rounded-2xl active:scale-95 transition-transform">
          <i id="icon-save" data-lucide="save" class="w-5 h-5"></i>
          <span id="label-save" class="text-xs tracking-wide">–°–û–•–†–ê–ù–ò–¢–¨</span>
        </button>
        <button id="btn-copy" class="flex flex-col items-center justify-center gap-1 py-3 bg-gray-900 text-white rounded-2xl active:scale-95 transition-transform">
          <i id="icon-copy" data-lucide="download" class="w-5 h-5"></i>
          <span id="label-copy" class="text-xs tracking-wide">–ö–û–ü–ò–Ø</span>
        </button>
        <button id="btn-csv" class="flex flex-col items-center justify-center gap-1 py-3 bg-gray-900 text-white rounded-2xl active:scale-95 transition-transform">
          <i id="icon-csv" data-lucide="download" class="w-5 h-5"></i>
          <span id="label-csv" class="text-xs tracking-wide">CSV</span>
        </button>
      </div>
    </div>
  </header>

  <!-- Main content -->
  <main class="px-4 py-4">
    <div id="categories-root"></div>
  </main>

<script>
  // ====== Data from original TSX ======
  const questions = [

    // 1. –≠–ö–°–ü–ï–†–¢–ù–û–°–¢–¨ - –≤–æ–ø—Ä–æ—Å—ã 1-14
    { num: 1, section: "–≠–ö–°–ü–ï–†–¢–ù–û–°–¢–¨", question: "–ö–∞–∫ —Ç—ã –ø–æ–ø–∞–ª –≤ —ç—Ç—É —Å—Ñ–µ—Ä—É? –ß–µ–º –∑–∞–Ω–∏–º–∞–ª—Å—è –¥–æ —ç—Ç–æ–≥–æ?", emoji: "üéØ" },
    { num: 2, section: "–≠–ö–°–ü–ï–†–¢–ù–û–°–¢–¨", question: "–ö–∞–∫ –¥–æ–ª–≥–æ —Ç—ã —É—á–∏–ª—Å—è –ø–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ –≤–æ—Ä–≤–∞—Ç—å—Å—è –≤ —Å—Ñ–µ—Ä—É? –ò –≥–¥–µ?", emoji: "üìö" },
    { num: 3, section: "–≠–ö–°–ü–ï–†–¢–ù–û–°–¢–¨", question: "–ö–∞–∫–∏–µ –±—ã–ª–∏ —Å—Ç—Ä–∞—Ö–∏ –ø–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ –Ω–∞—á–∞—Ç—å?", emoji: "üò∞" },
    { num: 4, section: "–≠–ö–°–ü–ï–†–¢–ù–û–°–¢–¨", question: "–†–∞—Å—Å–∫–∞–∂–∏ –æ —Å–≤–æ–µ–º –ø–µ—Ä–≤–æ–º‚Ä¶ (–ø—Ä–æ–µ–∫—Ç–µ, –≤—ã—Å—Ç—É–ø–ª–µ–Ω–∏–∏ –∏ —Ç.–¥.)", emoji: "üöÄ" },
    { num: 5, section: "–≠–ö–°–ü–ï–†–¢–ù–û–°–¢–¨", question: "–ö–∞–∫–∏–µ –≥–ª–∞–≤–Ω—ã–µ —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏ —Ç—ã –ø—Ä–µ–æ–¥–æ–ª–µ–≤–∞–ª –≤ –Ω–∞—á–∞–ª–µ —ç—Ç–æ–≥–æ –ø—É—Ç–∏?", emoji: "‚õ∞Ô∏è" },
    { num: 6, section: "–≠–ö–°–ü–ï–†–¢–ù–û–°–¢–¨", question: "–¢–µ–±—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–ª–∏, –∫–æ–≥–¥–∞ —Ç—ã –Ω–∞—á–∏–Ω–∞–ª –∏–ª–∏ –∫—Ä–∏—Ç–∏–∫–æ–≤–∞–ª–∏?", emoji: "ü§ù" },
    { num: 7, section: "–≠–ö–°–ü–ï–†–¢–ù–û–°–¢–¨", question: "–°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ –¥–æ –ø–µ—Ä–≤—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤?", emoji: "‚è∞" },
    { num: 8, section: "–≠–ö–°–ü–ï–†–¢–ù–û–°–¢–¨", question: "–ö–∞–∫–∏–µ —ç—Ç–∞–ø—ã —Ç—ã –ø—Ä–æ—à–µ–ª –≤ —Å–≤–æ–µ–π —Å—Ñ–µ—Ä–µ?", emoji: "ü™ú" },
    { num: 9, section: "–≠–ö–°–ü–ï–†–¢–ù–û–°–¢–¨", question: "–ö–∞–∫–∏–µ –∫–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è –±—ã–ª–∏ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ?", emoji: "üé≤" },
    { num: 10, section: "–≠–ö–°–ü–ï–†–¢–ù–û–°–¢–¨", question: "–ö–∞–∫–∏–µ –≥–ª–∞–≤–Ω—ã–µ —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏ –±—ã–ª–∏ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ?", emoji: "üßó" },
    { num: 11, section: "–≠–ö–°–ü–ï–†–¢–ù–û–°–¢–¨", question: "–†–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ —Å–≤–æ–∏ —Å–∞–º—ã–µ –∂–µ—Å—Ç–∫–∏–µ –æ–±–ª–æ–º—ã –∏ –ø—Ä–æ–≤–∞–ª—ã –≤ —Å—Ñ–µ—Ä–µ", emoji: "üíî" },
    { num: 12, section: "–≠–ö–°–ü–ï–†–¢–ù–û–°–¢–¨", question: "–†–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ –º–æ–º–µ–Ω—Ç –∫–æ–≥–¥–∞ —Ç—ã —á—É—Ç—å –Ω–µ –±—Ä–æ—Å–∏–ª", emoji: "üò§" },
    { num: 13, section: "–≠–ö–°–ü–ï–†–¢–ù–û–°–¢–¨", question: "–†–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ –ø–µ—Ä–≤—É—é –±–æ–ª—å—à—É—é –ø–æ–±–µ–¥—É", emoji: "üèÜ" },
    { num: 14, section: "–≠–ö–°–ü–ï–†–¢–ù–û–°–¢–¨", question: "–†–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ –º–æ–º–µ–Ω—Ç, –∫–æ–≥–¥–∞ —á—É–≤—Å—Ç–≤–æ–≤–∞–ª —Å–µ–±—è –Ω–∞ –ø–∏–∫–µ —É—Å–ø–µ—Ö–∞", emoji: "‚≠ê" },
    
    // 2. –ü–†–û–î–ê–ñ–ê –¢–ï–ú–´ - –≤–æ–ø—Ä–æ—Å—ã 15-30
    { num: 15, section: "–ü–†–û–î–ê–ñ–ê –¢–ï–ú–´", question: "–ü–æ—á–µ–º—É —Ç—ã —Å–µ–π—á–∞—Å –∑–∞–Ω–∏–º–∞–µ—à—å—Å—è –∏–º–µ–Ω–Ω–æ —ç—Ç–∏–º?", emoji: "üí°" },
    { num: 16, section: "–ü–†–û–î–ê–ñ–ê –¢–ï–ú–´", question: "–ö–∞–∫ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –∫–∞—á–µ—Å—Ç–≤–æ –±—ã—Ç–∞? (–∫–≤–∞—Ä—Ç–∏—Ä–∞, –µ–¥–∞, —Ç–∞–∫—Å–∏, —É–±–æ—Ä–∫–∞)", emoji: "üè†" },
    { num: 17, section: "–ü–†–û–î–ê–ñ–ê –¢–ï–ú–´", question: "–ö–∞–∫ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å —Ç–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å –¥—Ä—É–∑—å—è–º–∏?", emoji: "üë•" },
    { num: 18, section: "–ü–†–û–î–ê–ñ–ê –¢–ï–ú–´", question: "–ö–∞–∫ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å —Ç–≤–æ–µ —Å–∞–º–æ–æ—â—É—â–µ–Ω–∏–µ?", emoji: "üòä" },
    { num: 19, section: "–ü–†–û–î–ê–ñ–ê –¢–ï–ú–´", question: "–ö–∞–∫ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å —Ç–≤–æ—è –ª–∏—á–Ω–æ—Å—Ç—å?", emoji: "ü¶ã" },
    { num: 20, section: "–ü–†–û–î–ê–ñ–ê –¢–ï–ú–´", question: "–ß—Ç–æ —Ç—ã —Å–µ–±–µ –∫—É–ø–∏–ª –∏–ª–∏ –ø–æ–∑–≤–æ–ª–∏–ª –±–ª–∞–≥–æ–¥–∞—Ä—è —Å—Ñ–µ—Ä–µ?", emoji: "üéÅ" },
    { num: 21, section: "–ü–†–û–î–ê–ñ–ê –¢–ï–ú–´", question: "–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –Ω–∞ –ª–∏—á–Ω–æ–º —Ñ—Ä–æ–Ω—Ç–µ –±–ª–∞–≥–æ–¥–∞—Ä—è —ç—Ç–æ–π —Å—Ñ–µ—Ä–µ?", emoji: "‚ù§Ô∏è" },
    { num: 22, section: "–ü–†–û–î–ê–ñ–ê –¢–ï–ú–´", question: "–ö–∞–∫ —Ä–æ–¥–∏—Ç–µ–ª–∏ / –º—É–∂ / –æ–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏ —Ç–µ–ø–µ—Ä—å –∫ —Ç–µ–±–µ –æ—Ç–Ω–æ—Å—è—Ç—Å—è?", emoji: "üë®‚Äçüë©‚Äçüë¶" },
    { num: 23, section: "–ü–†–û–î–ê–ñ–ê –¢–ï–ú–´", question: "–û–ø–∏—à–∏ –º–æ–º–µ–Ω—Ç, –∫–æ–≥–¥–∞ —Ç—ã –ø–æ–Ω—è–ª, —á—Ç–æ –≤—Å–µ —ç—Ç–æ –Ω–µ –∑—Ä—è.", emoji: "üí´" },
    { num: 24, section: "–ü–†–û–î–ê–ñ–ê –¢–ï–ú–´", question: "–ü–æ—á–µ–º—É —Å—Ç–æ–∏—Ç –∑–∞–Ω–∏–º–∞—Ç—å—Å—è —Ç–≤–æ–µ–π —Å—Ñ–µ—Ä–æ–π?", emoji: "üé™" },
    { num: 25, section: "–ü–†–û–î–ê–ñ–ê –¢–ï–ú–´", question: "–ö–∞–∫–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –ø—Ä–æ–∫–∞—á–∏–≤–∞–µ—Ç —Ç–≤–æ—è —Å—Ñ–µ—Ä–∞?", emoji: "üí™" },
    { num: 26, section: "–ü–†–û–î–ê–ñ–ê –¢–ï–ú–´", question: "–ö–∞–∫—É—é –º–µ—á—Ç—É —Ç—ã –≤–æ–ø–ª–æ—Ç–∏–ª –±–ª–∞–≥–æ–¥–∞—Ä—è —Å—Ñ–µ—Ä–µ?", emoji: "üåü" },
    { num: 27, section: "–ü–†–û–î–ê–ñ–ê –¢–ï–ú–´", question: "–ù—Ä–∞–≤–∏—Ç—Å—è –ª–∏ —Ç–µ–±–µ —Å–∞–º –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã –≤ —Ç–≤–æ–µ–π —Å—Ñ–µ—Ä–µ?", emoji: "üé®" },
    { num: 28, section: "–ü–†–û–î–ê–ñ–ê –¢–ï–ú–´", question: "–ß–µ–º –æ–Ω –ª—É—á—à–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å—Ñ–µ—Ä?", emoji: "ü•á" },
    { num: 29, section: "–ü–†–û–î–ê–ñ–ê –¢–ï–ú–´", question: "–†–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ 3-—Ö –¥—Ä—É–∑–µ–π –∏–ª–∏ –∫–æ–ª–ª–µ–≥, —á—å—è –∂–∏–∑–Ω—å —Å–∏–ª—å–Ω–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–ª–∞—Å—å –±–ª–∞–≥–æ–¥–∞—Ä—è —Å—Ñ–µ—Ä–µ", emoji: "üåà" },
    { num: 30, section: "–ü–†–û–î–ê–ñ–ê –¢–ï–ú–´", question: "–ö–∞–∫ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –ª—é–¥–∏ –º–æ–≥—É—Ç –ø–æ–Ω—è—Ç—å —Ç–≤–æ–π —É—Å–ø–µ—Ö –≤ —Å—Ñ–µ—Ä–µ, –µ—Å–ª–∏ —Ç—ã –Ω–∏—á–µ–≥–æ –Ω–µ –±—É–¥–µ—à—å –≥–æ–≤–æ—Ä–∏—Ç—å?", emoji: "üëÄ" },
    
    // 3. –ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢ - –≤–æ–ø—Ä–æ—Å—ã 31-53
    { num: 31, section: "–ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢", question: "–ß–µ–º –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –Ω–æ–≤–∏—á–æ–∫ –æ—Ç –ø—Ä–æ—Ñ–∏?", emoji: "üéì" },
    { num: 32, section: "–ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢", question: "–ò–∑ –∫–∞–∫–∏—Ö 5‚Äì10 –ø–∞–∑–ª–æ–≤ —Å–æ—Å—Ç–æ–∏—Ç —É—Å–ø–µ—Ö –≤ —Ç–≤–æ–µ–π —Å—Ñ–µ—Ä–µ?", emoji: "üß©" },
    { num: 33, section: "–ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢", question: "–ö–∞–∫–∏–µ 5 —Å–∞–º—ã—Ö —á–∞—Å—Ç—ã—Ö –æ—à–∏–±–æ–∫ –≤ –∫–∞–∂–¥–æ–º –ø–∞–∑–ª–µ?", emoji: "‚ö†Ô∏è" },
    { num: 34, section: "–ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢", question: "–†–∞—Å—Å–∫–∞–∂–∏ 1 –ø—Ä–æ—Å—Ç—É—é, –ø—Ä–∏–º–µ–Ω–∏–º—É—é –∏ –ø–æ–ª–µ–∑–Ω—É—é —Ñ–∏—à–∫—É –∏–∑ —Ç–≤–æ–µ–π —Å—Ñ–µ—Ä—ã", emoji: "‚ú®" },
    { num: 35, section: "–ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢", question: "–ö–∞–∫–æ–π –ø–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ç–≤–æ–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤?", emoji: "üìã" },
    { num: 36, section: "–ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢", question: "–†–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ —Å–≤–æ–π —Å–∞–º—ã–π –±–æ–ª—å—à–æ–π –∏ –∫—Ä—É—Ç–æ–π –ø—Ä–æ–µ–∫—Ç / –∫–ª–∏–µ–Ω—Ç–∞", emoji: "üéØ" },
    { num: 37, section: "–ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢", question: "–†–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ —Å–∞–º—ã–π —Å—Ç—Ä–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç", emoji: "ü§™" },
    { num: 38, section: "–ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢", question: "–†–∞—Å—Å–∫–∞–∂–∏ —Å–∞–º—ã–π —Å–º–µ—à–Ω–æ–π —Å–ª—É—á–∞–π –∑–∞ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã", emoji: "üòÇ" },
    { num: 39, section: "–ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢", question: "–°–∫–æ–ª—å–∫–æ –ª–µ—Ç —Ç—ã —É–∂–µ –≤ —Å–≤–æ–µ–π —Å—Ñ–µ—Ä–µ?", emoji: "üìÖ" },
    { num: 40, section: "–ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢", question: "–ö–∞–∫–∏–µ –≥–ª–∞–≤–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∑–∞ —ç—Ç–æ –≤—Ä–µ–º—è?", emoji: "üèÖ" },
    { num: 41, section: "–ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢", question: "–ö–∞–∫ –º—ã –º–æ–∂–µ–º –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Ç–≤–æ–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —Ü–∏—Ñ—Ä–∞—Ö?", emoji: "üìä" },
    { num: 42, section: "–ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢", question: "–°–∫–æ–ª—å–∫–æ —Ç—ã —Å–µ–π—á–∞—Å –Ω–∞ —ç—Ç–æ–º –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–µ—à—å? (–µ—Å–ª–∏ —É–º–µ—Å—Ç–Ω–æ)", emoji: "üí∞" },
    { num: 43, section: "–ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢", question: "–ï—Å—Ç—å –ª–∏ —É —Ç–µ–±—è –∫–∞–∫–∏–µ-—Ç–æ –¥–∏–ø–ª–æ–º—ã, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã, –Ω–∞–≥—Ä–∞–¥—ã –∏–ª–∏ —Ä–µ–≥–∞–ª–∏–∏?", emoji: "üéñÔ∏è" },
    { num: 44, section: "–ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢", question: "–°–∫–æ–ª—å–∫–æ —É —Ç–µ–±—è –±—ã–ª–æ –∫–ª–∏–µ–Ω—Ç–æ–≤ / —É—á–µ–Ω–∏–∫–æ–≤? –ï—Å—Ç—å –ª–∏ —Å—Ä–µ–¥–∏ –Ω–∏—Ö –∏–∑–≤–µ—Å—Ç–Ω—ã–µ?", emoji: "üë®‚Äçüéì" },
    { num: 45, section: "–ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢", question: "–ö–∞–∫–∏–µ —Å–∞–º—ã–µ —á–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏ —É —Ç–≤–æ–∏—Ö —É—á–µ–Ω–∏–∫–æ–≤?", emoji: "üÜò" },
    { num: 46, section: "–ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢", question: "–ö–∞–∫ —Ç—ã –∏—Ö —Ä–µ—à–∞–µ—à—å?", emoji: "üîß" },
    { num: 47, section: "–ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢", question: "–ö–∞–∫–∏–µ —Å–∞–º—ã–µ —á–∞—Å—Ç—ã–µ 3‚Äì5 —Å—Ç—Ä–∞—Ö–æ–≤ —Ç–≤–æ–∏—Ö —É—á–µ–Ω–∏–∫–æ–≤?", emoji: "üëª" },
    { num: 48, section: "–ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢", question: "–ö–∞–∫–∏–µ –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–≤–æ–∏—Ö —É—á–µ–Ω–∏–∫–æ–≤ / –∫–ª–∏–µ–Ω—Ç–æ–≤?", emoji: "üéâ" },
    { num: 49, section: "–ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢", question: "–ß—Ç–æ —Å–∞–º–æ–µ –≥–ª–∞–≤–Ω–æ–µ –≤ —Ç–≤–æ–µ–π —Ä–∞–±–æ—Ç–µ?", emoji: "üéØ" },
    { num: 50, section: "–ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢", question: "–ß—Ç–æ –≥–ª–∞–≤–Ω–æ–µ, —á—Ç–æ–±—ã —Ö–æ—Ä–æ—à–æ –æ–±—É—á–∞—Ç—å –ª—é–¥–µ–π –≤ —Ç–≤–æ–µ–π —Å—Ñ–µ—Ä–µ?", emoji: "üë®‚Äçüè´" },
    { num: 51, section: "–ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢", question: "–ü–æ—á–µ–º—É —Å—Ç–æ–∏—Ç –ø–æ–π—Ç–∏ —É—á–∏—Ç—å—Å—è –∏–º–µ–Ω–Ω–æ –∫ —Ç–µ–±–µ?", emoji: "üåü" },
    { num: 52, section: "–ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢", question: "–ö–∞–∫–∏–µ –ª–∏—á–Ω–æ—Å—Ç–Ω—ã–µ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å —É—Å–ø–µ—à–Ω—ã–π‚Ä¶ (—Ç–≤–æ—è —Å—Ñ–µ—Ä–∞)", emoji: "üíé" },
    { num: 53, section: "–ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢", question: "–¢–≤–æ–∏ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã (–Ω–∞–≤—ã–∫–∏) –≤ —Ç–≤–æ–µ–π —Å—Ñ–µ—Ä–µ. –í —á–µ–º —Ç—ã –∫–æ—Ä–æ–ª—å?", emoji: "üëë" },
    
    // 4. –û –ö–£–†–°–ï - –≤–æ–ø—Ä–æ—Å—ã 54-64
    { num: 54, section: "–û –ö–£–†–°–ï", question: "–ú–æ–∂–Ω–æ –ª–∏ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ —Ç–≤–æ–π –∫—É—Ä—Å –æ–∫—É–ø–∞–µ—Ç—Å—è?", emoji: "üíµ" },
    { num: 55, section: "–û –ö–£–†–°–ï", question: "–ï—Å—Ç—å –ª–∏ —É —Ç–µ–±—è –∞–≤—Ç–æ—Ä—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã –∏ —Ñ–∏—à–∫–∏, –∫–æ—Ç–æ—Ä—ã–º —Ç—ã –æ–±—É—á–∞–µ—à—å?", emoji: "üîÆ" },
    { num: 56, section: "–û –ö–£–†–°–ï", question: "–ß—Ç–æ –µ—Å—Ç—å –Ω–∞ —Ç–≤–æ–µ–º –∫—É—Ä—Å–µ —á–µ–≥–æ –Ω–µ—Ç —É –¥—Ä—É–≥–∏—Ö?", emoji: "üéÅ" },
    { num: 57, section: "–û –ö–£–†–°–ï", question: "–ö—Ç–æ —Å–ø–∏–∫–µ—Ä—ã –Ω–∞ —Ç–≤–æ–µ–º –∫—É—Ä—Å–µ?", emoji: "üé§" },
    { num: 58, section: "–û –ö–£–†–°–ï", question: "–ö–∞–∫–∏–µ 5 –ª—É—á—à–∏—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —Ä–µ—à–µ–Ω–∏–π –Ω–∞ —Ç–≤–æ–µ–º –∫—É—Ä—Å–µ?", emoji: "‚öôÔ∏è" },
    { num: 59, section: "–û –ö–£–†–°–ï", question: "–î–∞–≤–∞–ª –ª–∏ —Ç—ã —ç—Ç–æ –æ–±—É—á–µ–Ω–∏–µ —Å–≤–æ–∏–º –±—Ä–∞—Ç—å—è–º, —Å–µ—Å—Ç—Ä–∞–º, —Ä–æ–¥–∏—Ç–µ–ª—è–º, –¥—Ä—É–∑—å—è–º?", emoji: "üë™" },
    { num: 60, section: "–û –ö–£–†–°–ï", question: "–ï—Å—Ç—å –ª–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ –∏—Ç–æ–≥—É –∫—É—Ä—Å–∞?", emoji: "üìú" },
    { num: 61, section: "–û –ö–£–†–°–ï", question: "–ö–∞–∫–∏–µ –≥–∞—Ä–∞–Ω—Ç–∏–∏ –º—ã –º–æ–∂–µ–º —é—Ä–∏–¥–∏—á–µ—Å–∫–∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å?", emoji: "‚úçÔ∏è" },
    { num: 62, section: "–û –ö–£–†–°–ï", question: "–ö–∞–∫–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å —Ö–æ—Ä–æ—à–∏–π —É—á–∏—Ç–µ–ª—å?", emoji: "üßë‚Äçüè´" },
    { num: 63, section: "–û –ö–£–†–°–ï", question: "–ö–∞–∫–∏–µ –∏–∑ –Ω–∏—Ö –µ—Å—Ç—å –≤ —Ç–µ–±–µ –∏ –∫–∞–∫ —ç—Ç–æ –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è?", emoji: "ü™û" },
    { num: 64, section: "–û –ö–£–†–°–ï", question: "–í —á–µ–º –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–≤–æ—è –ª—é–±–æ–≤—å –∫ —É—á–µ–Ω–∏–∫–∞–º?", emoji: "üíù" },
    
    // 5. –õ–ò–ß–ù–û–°–¢–¨ –ò –ñ–ò–ó–ù–¨ - –≤–æ–ø—Ä–æ—Å—ã 65-77
    { num: 65, section: "–õ–ò–ß–ù–û–°–¢–¨ –ò –ñ–ò–ó–ù–¨", question: "–ò–∑ —á–µ–≥–æ —Å–µ–π—á–∞—Å —Å–æ—Å—Ç–æ–∏—Ç —Ç–≤–æ—è –∂–∏–∑–Ω—å –ø–æ–º–∏–º–æ —Ä–∞–±–æ—Ç—ã?", emoji: "üåç" },
    { num: 66, section: "–õ–ò–ß–ù–û–°–¢–¨ –ò –ñ–ò–ó–ù–¨", question: "–ö–∞–∫ –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ç–≤–æ–π –æ–±—ã—á–Ω—ã–π –¥–µ–Ω—å?", emoji: "‚òÄÔ∏è" },
    { num: 67, section: "–õ–ò–ß–ù–û–°–¢–¨ –ò –ñ–ò–ó–ù–¨", question: "–î–∞–≤–∞–π —Å–æ—Å—Ç–∞–≤–∏–º –∫–æ–ª–µ—Å–æ –±–∞–ª–∞–Ω—Å–∞ —Ç–≤–æ–µ–π –∂–∏–∑–Ω–∏", emoji: "‚öñÔ∏è" },
    { num: 68, section: "–õ–ò–ß–ù–û–°–¢–¨ –ò –ñ–ò–ó–ù–¨", question: "–ö–∞–∫—É—é –≥–ª–∞–≤–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É —Ç—ã —Å–µ–π—á–∞—Å —Ä–µ—à–∞–µ—à—å? –ù–∞–ø—Ä–∏–º–µ—Ä, –±—Ä–æ—Å–∞—é –∫–∞–ª—å—è–Ω—ã", emoji: "üéØ" },
    { num: 69, section: "–õ–ò–ß–ù–û–°–¢–¨ –ò –ñ–ò–ó–ù–¨", question: "–í —á–µ–º —Ç—ã –≤–∏–¥–∏—à—å —Å–≤–æ—é –±–æ–ª—å—à—É—é –º–∏—Å—Å–∏—é?", emoji: "üåü" },
    { num: 70, section: "–õ–ò–ß–ù–û–°–¢–¨ –ò –ñ–ò–ó–ù–¨", question: "–ß—Ç–æ —Ç–µ–±—è –º–æ—Ç–∏–≤–∏—Ä—É–µ—Ç —Å–µ–π—á–∞—Å?", emoji: "üî•" },
    { num: 71, section: "–õ–ò–ß–ù–û–°–¢–¨ –ò –ñ–ò–ó–ù–¨", question: "–ö–∞–∫–∏–µ –ª—é–¥–∏ —Ç–µ–±—è –≤–¥–æ—Ö–Ω–æ–≤–ª—è–ª–∏ —Ä–∞–Ω—å—à–µ? –ò –∫–∞–∫–∏–µ —Å–µ–π—á–∞—Å?", emoji: "‚ú®" },
    { num: 72, section: "–õ–ò–ß–ù–û–°–¢–¨ –ò –ñ–ò–ó–ù–¨", question: "–¢–æ–ø 3 –∫–Ω–∏–≥–∏ –∏–ª–∏ —Ñ–∏–ª—å–º–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞ —Ç–µ–±—è –ø–æ–≤–ª–∏—è–ª–∏", emoji: "üìñ" },
    { num: 73, section: "–õ–ò–ß–ù–û–°–¢–¨ –ò –ñ–ò–ó–ù–¨", question: "–í –∫–∞–∫–æ–π —ç—Ç–∞–ø —Å–≤–æ–µ–π –∂–∏–∑–Ω–∏ —Ç—ã —Ä–æ—Å, –∫–∞–∫ –ª–∏—á–Ω–æ—Å—Ç—å —Å–∏–ª—å–Ω–µ–µ –≤—Å–µ–≥–æ?", emoji: "üå±" },
    { num: 74, section: "–õ–ò–ß–ù–û–°–¢–¨ –ò –ñ–ò–ó–ù–¨", question: "–ß—Ç–æ —Å–∏–ª—å–Ω–µ–µ –≤—Å–µ–≥–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤ —Ç–µ–±–µ –∑–∞ –ø—Ä–æ—à–ª—ã–µ 5 –ª–µ—Ç?", emoji: "üîÑ" },
    { num: 75, section: "–õ–ò–ß–ù–û–°–¢–¨ –ò –ñ–ò–ó–ù–¨", question: "–†–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ —Å–∞–º—É—é –±–æ–ª—å—à—É—é —è–º—É –≤ —Å–≤–æ–µ–π –∂–∏–∑–Ω–∏", emoji: "‚ö´" },
    { num: 76, section: "–õ–ò–ß–ù–û–°–¢–¨ –ò –ñ–ò–ó–ù–¨", question: "–ö–∞–∫–∏–µ —á—É–≤—Å—Ç–≤–∞ —Ç—ã —Ö–æ—á–µ—à—å –≤—ã–∑—ã–≤–∞—Ç—å —Å–≤–æ–∏–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º?", emoji: "üí´" },
    { num: 77, section: "–õ–ò–ß–ù–û–°–¢–¨ –ò –ñ–ò–ó–ù–¨", question: "–ö–∞–∫–∏—Ö –±–ª–æ–≥–µ—Ä–æ–≤ —Å–∞–º —Å–º–æ—Ç—Ä–∏—à—å?", emoji: "üì±" },
    
    // 6. –õ–ò–ß–ù–´–ï –í–û–ü–†–û–°–´ - –≤–æ–ø—Ä–æ—Å—ã 78-90
    { num: 78, section: "–õ–ò–ß–ù–´–ï –í–û–ü–†–û–°–´", question: "–ö–∞–∫–∏–µ —Ç–æ–ø-3 –ø–æ–±–µ–¥—ã –Ω–∞–¥ —Å–æ–±–æ–π, –∫–æ—Ç–æ—Ä—ã–º–∏ —Ç—ã –≥–æ—Ä–¥–∏—à—å—Å—è?", emoji: "üèÜ" },
    { num: 79, section: "–õ–ò–ß–ù–´–ï –í–û–ü–†–û–°–´", question: "–ö–∞–∫–∏–º 5‚Äì7 –≥–ª–∞–≤–Ω—ã–º –≤–µ—â–∞–º —Ç—ã –Ω–∞—É—á–∏–ª—Å—è –≤ —Å–≤–æ–µ–π –∂–∏–∑–Ω–∏?", emoji: "üéì" },
    { num: 80, section: "–õ–ò–ß–ù–´–ï –í–û–ü–†–û–°–´", question: "–ù–∞–∑–æ–≤–∏ 5‚Äì7 —Å–≤–æ–∏—Ö —É–±–µ–∂–¥–µ–Ω–∏–π, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —Ç–µ–±—è –Ω–µ–ª—å–∑—è –ø–µ—Ä–µ—É–±–µ–¥–∏—Ç—å.", emoji: "üóø" },
    { num: 81, section: "–õ–ò–ß–ù–´–ï –í–û–ü–†–û–°–´", question: "–•—É–¥—à–∏–π –ø–æ—Å—Ç—É–ø–æ–∫ –¥—Ä—É–≥–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ –≤ —Ç–≤–æ—é —Å—Ç–æ—Ä–æ–Ω—É.", emoji: "üí¢" },
    { num: 82, section: "–õ–ò–ß–ù–´–ï –í–û–ü–†–û–°–´", question: "–í —á–µ–º —Ç–µ–±–µ –ø–æ–≤–µ–∑–ª–æ?", emoji: "üçÄ" },
    { num: 83, section: "–õ–ò–ß–ù–´–ï –í–û–ü–†–û–°–´", question: "–ß—Ç–æ —Ç—ã –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ —Ü–µ–Ω–∏—à—å –≤ –¥—Ä—É–≥–∏—Ö –ª—é–¥—è—Ö?", emoji: "üíé" },
    { num: 84, section: "–õ–ò–ß–ù–´–ï –í–û–ü–†–û–°–´", question: "–ö –∫–∞–∫–∏–º –ª—é–¥—è–º —Ç—ã –∏—Å–ø—ã—Ç—ã–≤–∞–µ—à—å –ø—Ä–µ–∑—Ä–µ–Ω–∏–µ?", emoji: "üòí" },
    { num: 85, section: "–õ–ò–ß–ù–´–ï –í–û–ü–†–û–°–´", question: "–ß–µ–≥–æ —Ç—ã –±–æ–∏—à—å—Å—è –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –≤ –∂–∏–∑–Ω–∏?", emoji: "üò±" },
    { num: 86, section: "–õ–ò–ß–ù–´–ï –í–û–ü–†–û–°–´", question: "–ö–∞–∫–∏–µ –º—ã—Å–ª–∏ —Ç—ã —Ö–æ—á–µ—à—å –¥–æ–Ω–µ—Å—Ç–∏ –¥–æ –ª—é–¥–µ–π —Å–≤–æ–∏–º –±–ª–æ–≥–æ–º?", emoji: "üí≠" },
    { num: 87, section: "–õ–ò–ß–ù–´–ï –í–û–ü–†–û–°–´", question: "–¢—ã –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö? –ú–æ–∂–µ–º –ª–∏ —á—Ç–æ-—Ç–æ –∏–∑ —ç—Ç–æ–≥–æ –ø–æ–∫–∞–∑–∞—Ç—å –≤ –±–ª–æ–≥–µ?", emoji: "üíë" },
    { num: 88, section: "–õ–ò–ß–ù–´–ï –í–û–ü–†–û–°–´", question: "–ß—Ç–æ —Ç—ã –≤—Å–µ–º–∏ —Å–∏–ª–∞–º–∏ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ—à—å –Ω–∞ –ø–æ—Ç–æ–º?", emoji: "‚è≥" },
    { num: 89, section: "–õ–ò–ß–ù–´–ï –í–û–ü–†–û–°–´", question: "–ö–∞–∫–∏–µ —Ç–µ–º—ã —Ç–µ–±–µ —Å–∞–º–æ–º—É —Å–µ–π—á–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã?", emoji: "ü§î" },
    { num: 90, section: "–õ–ò–ß–ù–´–ï –í–û–ü–†–û–°–´", question: "–ß—Ç–æ —Å–∞–º–æ–≥–æ –∫—Ä—É—Ç–æ–≥–æ —Ç—ã —É–∑–Ω–∞–ª –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ?", emoji: "üéâ" },
    
    // 7. –ü–û–ò–°–ö –°–Æ–ñ–ï–¢–ù–´–• –õ–ò–ù–ò–ô - –≤–æ–ø—Ä–æ—Å—ã 91-98
    { num: 91, section: "–ü–û–ò–°–ö –°–Æ–ñ–ï–¢–ù–´–• –õ–ò–ù–ò–ô", question: "–û —á–µ–º —Ç—ã —Å–µ–π—á–∞—Å –º–µ—á—Ç–∞–µ—à—å?", emoji: "üí≠" },
    { num: 92, section: "–ü–û–ò–°–ö –°–Æ–ñ–ï–¢–ù–´–• –õ–ò–ù–ò–ô", question: "–ö–∞–∫–∏–µ –∑–∞–¥–∞—á–∏ –∏ –ø—Ä–æ–±–ª–µ–º—ã —Ç—ã —Å–µ–π—á–∞—Å —Ä–µ—à–∞–µ—à—å?", emoji: "üéØ" },
    { num: 93, section: "–ü–û–ò–°–ö –°–Æ–ñ–ï–¢–ù–´–• –õ–ò–ù–ò–ô", question: "–ù–∞ —á—Ç–æ —Ç—ã –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—Ç—Ä–∞—Ç–∏–ª –Ω–∞ –ø—Ä–æ—à–ª–æ–π –Ω–µ–¥–µ–ª–µ?", emoji: "‚è∞" },
    { num: 94, section: "–ü–û–ò–°–ö –°–Æ–ñ–ï–¢–ù–´–• –õ–ò–ù–ò–ô", question: "–ï—Å—Ç—å –ª–∏ —Å–µ–π—á–∞—Å –∫–∞–∫–∞—è-—Ç–æ —É–≥—Ä–æ–∑–∞, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞–≤–∏—Å–ª–∞ –Ω–∞–¥ —Ç–æ–±–æ–π? (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–µ–ø–æ—Ä—Ç–∞—Ü–∏—è)", emoji: "‚ö°" },
    { num: 95, section: "–ü–û–ò–°–ö –°–Æ–ñ–ï–¢–ù–´–• –õ–ò–ù–ò–ô", question: "–í –∫–∞–∫–∏—Ö —Å—Ñ–µ—Ä–∞—Ö –∂–∏–∑–Ω–∏ —Ç—ã —Å–µ–π—á–∞—Å –ø—ã—Ç–∞–µ—à—å—Å—è —Ä–∞—Å—Ç–∏?", emoji: "üìà" },
    { num: 96, section: "–ü–û–ò–°–ö –°–Æ–ñ–ï–¢–ù–´–• –õ–ò–ù–ò–ô", question: "–ö–∞–∫–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ —Ü–µ–ª–∏ –ø–æ –∫–∞–∂–¥–æ–π –∏–∑ —ç—Ç–∏—Ö —Å—Ñ–µ—Ä?", emoji: "üéØ" },
    { num: 97, section: "–ü–û–ò–°–ö –°–Æ–ñ–ï–¢–ù–´–• –õ–ò–ù–ò–ô", question: "–ü–æ—á–µ–º—É –¥–ª—è —Ç–µ–±—è —ç—Ç–æ –≤–∞–∂–Ω–æ?", emoji: "‚ù§Ô∏è" },
    { num: 98, section: "–ü–û–ò–°–ö –°–Æ–ñ–ï–¢–ù–´–• –õ–ò–ù–ò–ô", question: "–ß—Ç–æ –º–µ—à–∞–µ—Ç —ç—Ç–∏ —Ü–µ–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å?", emoji: "üöß" },
  
  ];

  const categories = [
    { name: '–≠–ö–°–ü–ï–†–¢–ù–û–°–¢–¨', range: [1, 14], emoji: 'üéØ' },
    { name: '–ü–†–û–î–ê–ñ–ê –¢–ï–ú–´', range: [15, 30], emoji: 'üí°' },
    { name: '–ó–ù–ê–ù–ò–Ø –ò –û–ü–´–¢', range: [31, 53], emoji: 'üéì' },
    { name: '–û –ö–£–†–°–ï', range: [54, 64], emoji: 'üìö' },
    { name: '–õ–ò–ß–ù–û–°–¢–¨ –ò –ñ–ò–ó–ù–¨', range: [65, 77], emoji: 'üåü' },
    { name: '–õ–ò–ß–ù–´–ï –í–û–ü–†–û–°–´', range: [78, 90], emoji: 'üí≠' },
    { name: '–°–Æ–ñ–ï–¢–ù–´–ï –õ–ò–ù–ò–ò', range: [91, 98], emoji: 'üé¨' },
  ];

  // ====== State ======
  let answers = {};
  let expandedCategories = {};
  let saveStatus = '';
  let autosaveTimer = null;

  // ====== Helpers ======
  function loadAnswers() {
    const saved = localStorage.getItem('expertAnswers');
    if (saved) {
      try {
        answers = JSON.parse(saved) || {};
      } catch (e) {
        console.error('Error loading saved data:', e);
      }
    }
  }

  function autosave() {
    clearTimeout(autosaveTimer);
    autosaveTimer = setTimeout(() => {
      if (Object.keys(answers).length > 0) {
        localStorage.setItem('expertAnswers', JSON.stringify(answers));
      }
    }, 1000);
  }

  function totalFilledCount() {
    return Object.keys(answers).filter(k => answers[k] && String(answers[k]).trim()).length;
  }

  function getCategoryProgress(start, end) {
    const total = end - start + 1;
    const filled = questions
      .filter(q => q.num >= start && q.num <= end)
      .filter(q => answers[q.num] && String(answers[q.num]).trim())
      .length;
    return { filled, total, percentage: (filled / total) * 100 };
  }

  function setSaveStatusUI(type) {
    saveStatus = type;

    // reset all
    const map = [
      ['save', 'btn-save', 'icon-save', 'label-save'],
      ['copied', 'btn-copy', 'icon-copy', 'label-copy'],
      ['exported', 'btn-csv', 'icon-csv', 'label-csv'],
    ];

    map.forEach(([key, btnId, iconId, labelId]) => {
      const icon = document.getElementById(iconId);
      const label = document.getElementById(labelId);
      if (!icon || !label) return;

      if (type === key) {
        icon.setAttribute('data-lucide', 'check');
        label.textContent = '–ì–û–¢–û–í–û';
      } else {
        icon.setAttribute('data-lucide', key === 'save' ? 'save' : 'download');
        label.textContent = key === 'save' ? '–°–û–•–†–ê–ù–ò–¢–¨' : (key === 'copied' ? '–ö–û–ü–ò–Ø' : 'CSV');
      }
    });

    lucide.createIcons();

    setTimeout(() => {
      saveStatus = '';
      map.forEach(([key, btnId, iconId, labelId]) => {
        const icon = document.getElementById(iconId);
        const label = document.getElementById(labelId);
        if (!icon || !label) return;
        icon.setAttribute('data-lucide', key === 'save' ? 'save' : 'download');
        label.textContent = key === 'save' ? '–°–û–•–†–ê–ù–ò–¢–¨' : (key === 'copied' ? '–ö–û–ü–ò–Ø' : 'CSV');
      });
      lucide.createIcons();
    }, 2000);
  }

  function saveProgress() {
    localStorage.setItem('expertAnswers', JSON.stringify(answers));
    setSaveStatusUI('save');
  }

  function exportToCSV() {
    try {
      const csvContent = [
        ['‚Ññ', '–†–∞–∑–¥–µ–ª', '–í–æ–ø—Ä–æ—Å', '–û—Ç–≤–µ—Ç'],
        ...questions.map(q => [
          q.num,
          q.section,
          q.question,
          answers[q.num] || ''
        ])
      ].map(row => row.map(cell => `"${String(cell).replace(/"/g, '""')}"`).join(',')).join('\n');

      const blob = new Blob(['\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = '–æ–ø—Ä–æ—Å–Ω–∏–∫_—ç–∫—Å–ø–µ—Ä—Ç–∞.csv';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      setTimeout(() => URL.revokeObjectURL(url), 100);

      setSaveStatusUI('exported');
    } catch (error) {
      console.error('Export error:', error);
      alert('–û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞');
    }
  }

  function copyAsText() {
    const textContent = questions
      .map(q => {
        const answer = answers[q.num] || '[–ù–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ]';
        return `\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n${q.num}. ${q.emoji} ${q.question}\n\n–û–¢–í–ï–¢:\n${answer}\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ`;
      })
      .join('\n');

    navigator.clipboard.writeText(textContent).then(() => {
      setSaveStatusUI('copied');
    });
  }

  function toggleCategory(name) {
    expandedCategories[name] = !expandedCategories[name];
    const body = document.getElementById(`cat-body-${slug(name)}`);
    const up = document.getElementById(`chev-up-${slug(name)}`);
    const down = document.getElementById(`chev-down-${slug(name)}`);
    if (body) body.classList.toggle('hidden', !expandedCategories[name]);
    if (up && down) {
      up.classList.toggle('hidden', !expandedCategories[name]);
      down.classList.toggle('hidden', expandedCategories[name]);
    }
  }

  function slug(name) {
    return name.replace(/\s+/g,'-').replace(/[^a-zA-Z0-9\-–∞-—è–ê-–Ø—ë–Å]/g,'').toLowerCase();
  }

  function updateTotalProgressUI() {
    const filled = totalFilledCount();
    const percent = (filled / 98) * 100;
    const totalFilledEl = document.getElementById('total-filled');
    const totalBarEl = document.getElementById('total-bar');
    if (totalFilledEl) {
      totalFilledEl.innerHTML = `${filled}<span class="text-gray-600">/98</span>`;
    }
    if (totalBarEl) {
      totalBarEl.style.width = `${percent}%`;
    }
  }

  function updateCategoryUI(cat) {
    const s = slug(cat.name);
    const prog = getCategoryProgress(cat.range[0], cat.range[1]);
    const filledEl = document.getElementById(`cat-filled-${s}`);
    const barEl = document.getElementById(`cat-bar-${s}`);
    if (filledEl) {
      filledEl.innerHTML = `${prog.filled}<span class="text-gray-600">/${prog.total}</span>`;
    }
    if (barEl) {
      barEl.style.width = `${prog.percentage}%`;
    }
  }

  function handleAnswerChange(num, value, cat) {
    answers[num] = value;
    autosave();

    // badge update
    const badge = document.getElementById(`badge-${num}`);
    if (badge) {
      badge.classList.remove('bg-gray-800','text-gray-500','bg-blue-500','text-white');
      if (value && String(value).trim()) {
        badge.classList.add('bg-blue-500','text-white');
      } else {
        badge.classList.add('bg-gray-800','text-gray-500');
      }
    }

    updateCategoryUI(cat);
    updateTotalProgressUI();
  }

  // ====== Render ======
  function renderCategories() {
    const root = document.getElementById('categories-root');
    if (!root) return;
    root.innerHTML = '';

    categories.forEach(cat => {
      const s = slug(cat.name);
      const prog = getCategoryProgress(cat.range[0], cat.range[1]);
      const isExpanded = !!expandedCategories[cat.name];
      const catQuestions = questions.filter(q => q.num >= cat.range[0] && q.num <= cat.range[1]);

      const wrapper = document.createElement('section');
      wrapper.className = 'mb-4';

      wrapper.innerHTML = `
        <div class="mb-3">
          <button class="w-full bg-gray-900 rounded-2xl p-4 mb-3 active:scale-98 transition-transform" id="cat-toggle-${s}">
            <div class="flex items-center justify-between mb-3">
              <div class="flex items-center gap-3">
                <span class="text-2xl">${cat.emoji}</span>
                <div class="text-left">
                  <div class="text-sm text-white tracking-wide">${cat.name}</div>
                  <div class="text-xs text-gray-500 tracking-widest">${cat.range[0]}-${cat.range[1]}</div>
                </div>
              </div>
              <div class="flex items-center gap-3">
                <span class="text-sm text-white" id="cat-filled-${s}">${prog.filled}<span class="text-gray-600">/${prog.total}</span></span>
                <span>
                  <i id="chev-up-${s}" data-lucide="chevron-up" class="w-5 h-5 text-gray-400 ${isExpanded ? '' : 'hidden'}"></i>
                  <i id="chev-down-${s}" data-lucide="chevron-down" class="w-5 h-5 text-gray-400 ${isExpanded ? 'hidden' : ''}"></i>
                </span>
              </div>
            </div>
            <div class="h-1.5 bg-gray-800 rounded-full overflow-hidden">
              <div id="cat-bar-${s}" class="h-full bg-blue-500 rounded-full transition-all duration-500" style="width:${prog.percentage}%"></div>
            </div>
          </button>

          <div id="cat-body-${s}" class="${isExpanded ? '' : 'hidden'}">
            <div class="space-y-3">
              ${catQuestions.map(q => {
                const val = answers[q.num] || '';
                const filled = val && String(val).trim();
                return `
                  <div class="bg-gray-900 rounded-2xl p-4 border-2 border-gray-800 transition-all" data-qnum="${q.num}">
                    <div class="flex items-start gap-3 mb-3">
                      <span class="text-2xl flex-shrink-0">${q.emoji}</span>
                      <div class="flex-1 min-w-0">
                        <div id="badge-${q.num}" class="inline-flex items-center justify-center w-7 h-7 rounded-full text-xs mb-2 ${filled ? 'bg-blue-500 text-white' : 'bg-gray-800 text-gray-500'}">
                          ${q.num}
                        </div>
                        <p class="text-sm text-white leading-relaxed mb-1">${q.question}</p>
                      </div>
                    </div>
                    <textarea
                      id="answer-${q.num}"
                      class="w-full px-4 py-4 bg-black border border-gray-700 rounded-xl text-sm text-white placeholder-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-y transition-all"
                      style="min-height:140px;font-weight:700"
                      placeholder="–ù–∞–ø–∏—à–∏ –æ—Ç–≤–µ—Ç...">${val.replace(/</g,'&lt;').replace(/>/g,'&gt;')}</textarea>
                  </div>
                `;
              }).join('')}
            </div>
          </div>
        </div>
      `;

      root.appendChild(wrapper);

      // bind toggle
      document.getElementById(`cat-toggle-${s}`).addEventListener('click', () => toggleCategory(cat.name));

      // bind textareas
      catQuestions.forEach(q => {
        const ta = document.getElementById(`answer-${q.num}`);
        if (ta) {
          ta.addEventListener('input', (e) => handleAnswerChange(q.num, e.target.value, cat));
        }
      });
    });

    lucide.createIcons();
  }

  // ====== Init ======
  loadAnswers();
  updateTotalProgressUI();
  renderCategories();
  updateTotalProgressUI();

  document.getElementById('btn-save').addEventListener('click', saveProgress);
  document.getElementById('btn-copy').addEventListener('click', copyAsText);
  document.getElementById('btn-csv').addEventListener('click', exportToCSV);

  lucide.createIcons();
</script>
</body>
</html>
